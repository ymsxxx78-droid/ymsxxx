<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ENGLISH HELL CAMP â€” ìˆ˜ëŠ¥ì˜ì–´ ì§€ì˜¥í›ˆë ¨ì†Œ</title>
  <!-- Excel(XLSX) íŒŒì„œ -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    :root {
      --bg:#0a0a0a; --card:#141414; --ink:#f3f3f3; --ink-dim:#b5b5b5; --red:#d00000; --red-2:#ff1e1e; --ok:#00d68f;
    }
    *{box-sizing:border-box} html,body{height:100%} body{margin:0;background:radial-gradient(1200px 800px at 20% -10%, rgba(208,0,0,.15), transparent 60%),var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif}
    .wrap{display:grid;grid-template-rows:auto 1fr;min-height:100dvh}
    header{position:sticky;top:0;z-index:10;background:linear-gradient(180deg,rgba(0,0,0,.8),rgba(0,0,0,.3));border-bottom:1px solid rgba(255,255,255,.06);backdrop-filter:blur(6px)}
    .topbar{display:flex;align-items:center;gap:16px;padding:14px 20px;max-width:1100px;margin:0 auto}
    .brand{display:flex;align-items:center;gap:12px;letter-spacing:.6px;font-weight:800;text-transform:uppercase}
    .brand .logo{width:34px;height:34px;border:2px solid var(--red);border-radius:10px;display:grid;place-items:center;color:var(--red);font-weight:900}
    nav{margin-left:auto;display:flex;gap:8px;flex-wrap:wrap}
    .tab{border:1px solid rgba(255,255,255,.08);background:#111;color:#eee;padding:10px 14px;border-radius:10px;cursor:pointer;transition:.2s}
    .tab:hover{border-color:rgba(255,255,255,.2);transform:translateY(-1px)} .tab.active{background:linear-gradient(180deg,#1b1b1b,#131313);border-color:var(--red);box-shadow:inset 0 0 0 1px rgba(208,0,0,.5)}
    main{max-width:1100px;width:100%;margin:18px auto 40px;padding:0 16px;display:grid;grid-template-columns:1.2fr .8fr;gap:18px}
    .card{background:linear-gradient(180deg,#171717,#0f0f0f);border:1px solid rgba(255,255,255,.07);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35),inset 0 1px 0 rgba(255,255,255,.04)}
    .card .hd{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.06)}
    .card .hd h3{margin:0;font-size:16px;letter-spacing:.3px;text-transform:uppercase}
    .badge{font-size:12px;padding:4px 8px;border:1px solid rgba(255,255,255,.14);border-radius:999px;color:var(--ink-dim)}
    .card .bd{padding:16px}
    .hero{grid-column:1/-1;display:grid;grid-template-columns:1fr auto;gap:14px;align-items:center;padding:14px 16px;border:1px dashed rgba(208,0,0,.4);border-radius:16px;background:linear-gradient(180deg,rgba(208,0,0,.08),rgba(208,0,0,.02))}
    .hero h1{margin:6px 0 2px;font-size:clamp(24px,4vw,36px);letter-spacing:.6px}
    .hero p{margin:0;color:var(--ink-dim)} .cta{display:flex;gap:10px}
    .btn{appearance:none;border:none;border-radius:12px;padding:12px 16px;font-weight:800;letter-spacing:.5px;text-transform:uppercase;cursor:pointer;transition:.2s}
    .btn-primary{background:linear-gradient(180deg,var(--red-2),var(--red));color:#fff;box-shadow:0 6px 18px rgba(208,0,0,.35)}
    .btn-primary:hover{filter:brightness(1.07);transform:translateY(-1px)} .btn-ghost{background:#151515;color:#eee;border:1px solid rgba(255,255,255,.1)}
    .grid{display:grid;gap:14px}
    .statusbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .chip{font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:#121212;color:#ddd}
    .progress{height:10px;background:#1a1a1a;border-radius:999px;overflow:hidden;border:1px solid rgba(255,255,255,.08)} .progress>i{display:block;height:100%;width:0%;background:linear-gradient(90deg,#ff4d4d,#d00000);transition:width .25s ease}
    .word-card{display:grid;gap:14px;border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:18px;background:radial-gradient(600px 200px at 0% 0%, rgba(255,50,50,.09), transparent 60%), #111}
    .word{font-size:clamp(28px,6vw,52px);font-weight:900;letter-spacing:.5px;color:#fff;text-shadow:0 4px 20px rgba(208,0,0,.15)} .meaning{color:var(--ink-dim);font-size:15px}
    .answer-row{display:flex;gap:10px}
    .input{flex:1;background:#0f0f0f;color:#fff;border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:12px 14px;outline:none;box-shadow:inset 0 1px 0 rgba(255,255,255,.05)}
    .input:focus{border-color:var(--red);box-shadow:0 0 0 4px rgba(208,0,0,.15),inset 0 1px 0 rgba(255,255,255,.05)}
    .timer{font-weight:900;letter-spacing:.5px;color:#fff} .timer.bad{color:var(--red-2)}
    .ex{padding:10px 12px;background:#101010;border:1px solid rgba(255,255,255,.08);border-radius:10px}
    .panel{padding:14px}
    .metric{display:flex;align-items:center;justify-content:space-between;padding:12px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.08);background:#101010}
    .table{width:100%;border-collapse:collapse}
    .table th,.table td{padding:12px;border-bottom:1px dashed rgba(255,255,255,.08);text-align:left}
    footer{max-width:1100px;margin:24px auto 60px;padding:0 16px;color:var(--ink-dim)}
    @media (max-width:920px){main{grid-template-columns:1fr}}
    .toast{position:fixed;right:16px;bottom:16px;background:#151515;border:1px solid rgba(255,255,255,.12);padding:12px 14px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,.4);opacity:0;transform:translateY(6px);transition:.25s}
    .toast.show{opacity:1;transform:none}
    .uploader{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    input[type=file]{background:#0f0f0f;border:1px solid rgba(255,255,255,.12);border-radius:10px;padding:10px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="topbar">
        <div class="brand" aria-label="ì‚¬ì´íŠ¸ ë¡œê³ ">
          <div class="logo">EH</div>
          <div>
            <div style="font-size:12px;color:var(--ink-dim);line-height:1;">NO MERCY</div>
            <div style="font-size:18px;line-height:1.2;">ENGLISH HELL CAMP</div>
          </div>
        </div>
        <nav aria-label="ì£¼ìš” ë©”ë‰´">
          <button class="tab active" data-view="trainer">ë‹¨ì–´í›ˆë ¨ì†Œ</button>
          <button class="tab" data-view="report">ë‚´ ì„±ì í‘œ</button>
        </nav>
      </div>
    </header>

    <main>
      <!-- HERO -->
      <section class="hero card" role="region" aria-labelledby="hero-title">
        <div>
          <div class="badge" id="badgeInfo">ì˜¤ëŠ˜ì˜ ë¯¸ì…˜ â€¢ ë‹¨ì–´ <b id="badgeCount">0</b> â€¢ ì œí•œì‹œê°„ 10ì´ˆ</div>
          <h1 id="hero-title">ì˜¤ëŠ˜ë„ ë„ë§ì¹  ê±´ê°€? <span style="color:var(--red-2)">ê³µë¶€í•´.</span> ì§€ê¸ˆ.</h1>
          <p>STUDY OR DIE. ì‹¤íŒ¨ ì‹œ ì¬ì‹œí—˜. 3ì¼ ë¯¸ì ‘ì† = ì§•ê³„.</p>
        </div>
        <div class="cta">
          <button class="btn btn-primary" id="startBtn">í›ˆë ¨ ì‹œì‘</button>
          <button class="btn btn-ghost" id="retryBtn" title="í˜„ì¬ ì„¸íŠ¸ ì¬ì‹œì‘" disabled>ì¬ì‹œí—˜</button>
        </div>
      </section>

      <!-- LEFT COLUMN -->
      <section id="leftCol" class="grid">
        <!-- TRAINER -->
        <article id="view-trainer" class="card" aria-live="polite">
          <div class="hd">
            <h3>ë‹¨ì–´ ì•”ê¸° í…ŒìŠ¤íŠ¸</h3>
            <span class="badge">HELL MODE</span>
          </div>
          <div class="bd grid">
            <div class="statusbar">
              <span class="chip">ì§„í–‰ë„ <strong id="progressText">0/0</strong></span>
              <span class="chip">ì •ë‹µ <strong id="correctText">0</strong></span>
              <span class="chip">ì˜¤ë‹µ <strong id="wrongText">0</strong></span>
              <span class="chip">ì—°ì†ì •ë‹µ <strong id="streakText">0ğŸ”¥</strong></span>
              <span class="chip timer" id="timer">00.0s</span>
            </div>
            <div class="progress" aria-hidden="true"><i id="bar"></i></div>

            <div class="answer-row" id="modeRow">
              <button class="btn btn-primary" id="modeTrain" aria-pressed="true">í›ˆë ¨ ëª¨ë“œ</button>
              <button class="btn btn-ghost" id="modeTest" aria-pressed="false">í…ŒìŠ¤íŠ¸ ëª¨ë“œ</button>
              <span class="badge" id="modeBadge" style="display:none">íŒíŠ¸ ì—†ìŒ(í…ŒìŠ¤íŠ¸)</span>
            </div>

            <div class="word-card">
              <div class="word" id="word">â€”</div>
              <div class="meaning" id="hint">íŒíŠ¸: â€”</div>
              <div class="answer-row">
                <input id="answer" class="input" type="text" placeholder="ëœ»(í•œêµ­ì–´) ì…ë ¥ â†’ Enter" autocomplete="off" disabled />
                <button id="giveup" class="btn btn-ghost" disabled>í¬ê¸°</button>
              </div>
              <div id="feedback" class="meaning" aria-live="polite"></div>
            </div>

            <div class="grid">
              <div class="uploader">
                <input type="file" id="excelFile" accept=".xlsx,.xls" />
                <button class="btn btn-ghost" id="loadBtn">ë‹¨ì–´ì„¸íŠ¸ ì—…ë¡œë“œ</button>
                <span class="badge" id="uploadInfo">ìƒ˜í”Œ ì„¸íŠ¸ ì‚¬ìš© ì¤‘</span>
              </div>
              <details style="opacity:.9">
                <summary>ì—‘ì…€ í˜•ì‹ ì•ˆë‚´</summary>
                <div class="meaning">ì²« ì—´ = ì˜ë‹¨ì–´, ë‘ ë²ˆì§¸ ì—´ = í•œê¸€ ëœ»<br/>ì˜ˆ) <code>apple | ì‚¬ê³¼</code></div>
              </details>
            </div>

            <div class="examples" id="exampleList"></div>
          </div>
        </article>

        <!-- EXAMPLES VIEW -->
        <article id="view-examples" class="card" hidden>
          <div class="hd">
            <h3>ë¬¸ì¥ ì˜ˆì‹œ (ë‹¨ì–´ ì—°ê³„)</h3>
            <span class="badge">See â€¢ Understand â€¢ Conquer</span>
          </div>
          <div class="bd">
            <div class="answer-row" style="margin-bottom:10px;">
              <input id="exSearch" class="input" placeholder="ë‹¨ì–´ ì…ë ¥ (ì˜ˆ: abandon)" />
              <button class="btn btn-primary" id="exGo">ì˜ˆë¬¸ ë³´ê¸°</button>
            </div>
            <div id="exOut" class="grid"></div>
          </div>
        </article>

        <!-- READING VIEW -->
        <article id="view-reading" class="card" hidden>
          <div class="hd">
            <h3>ë…í•´ ë¬¸ì œ ìƒì„± (ë‹¨ì–´ ê¸°ë°˜)</h3>
            <span class="badge">ë¹ˆì¹¸/ë¬¸ì¥ì‚½ì…/ì¶”ë¡ </span>
          </div>
          <div class="bd grid">
            <div class="answer-row">
              <input id="rdWord" class="input" placeholder="ë‹¨ì–´ ì…ë ¥ (ì˜ˆ: abandon)" />
              <button class="btn btn-primary" id="rdMake">ë¬¸ì œ ìƒì„±</button>
            </div>
            <textarea id="rdPassage" readonly style="width:100%;min-height:120px;background:#0f0f0f;border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:12px;color:#eee" placeholder="ì—¬ê¸°ì— ìë™ ìƒì„±ëœ ì§€ë¬¸ì´ í‘œì‹œë©ë‹ˆë‹¤."></textarea>
            <div class="answer-row">
              <input id="rdAns" class="input" placeholder="ì •ë‹µ ì…ë ¥" />
              <button class="btn btn-ghost" id="rdCheck">ì •ë‹µí™•ì¸</button>
            </div>
            <div id="rdFeedback" class="meaning"></div>
          </div>
        </article>
      </section>

      <!-- RIGHT COLUMN -->
      <aside class="grid">
        <section class="card panel">
          <div class="hd">
            <h3>ë‚´ í›ˆë ¨ ìƒíƒœ</h3>
            <span class="badge">STUDY OR DIE</span>
          </div>
          <div class="bd grid">
            <div class="metric"><span>ì˜¤ëŠ˜ í•™ìŠµì‹œê°„</span><strong id="m-time">00:00</strong></div>
            <div class="metric"><span>ì„±ê³µë¥ </span><strong id="m-acc">0%</strong></div>
            <div class="metric"><span>íŒ¨ë°° ì¹´ìš´íŠ¸</span><strong id="m-fail">0</strong></div>
            <div class="metric"><span>ì§€ì˜¥íƒˆì¶œê¶Œ</span><strong id="m-pass">0</strong></div>
          </div>
        </section>

        <section id="view-report" class="card panel" hidden>
          <div class="hd">
            <h3>í›ˆë ¨ ë¦¬í¬íŠ¸</h3>
            <span class="badge">Daily / Weekly</span>
          </div>
          <div class="bd">
            <ul id="reportList" style="margin:0; padding-left:18px; line-height:1.7"></ul>
          </div>
        </section>

        <section id="view-ranking" class="card panel" hidden>
          <div class="hd">
            <h3>ì§€ì˜¥ ë­í‚¹ (ìƒ˜í”Œ)</h3>
            <span class="badge">TOP 10 Survivors</span>
          </div>
          <div class="bd">
            <table class="table" aria-label="ë­í‚¹ í…Œì´ë¸”">
              <thead><tr><th>#</th><th>ë‹‰ë„¤ì„</th><th>ì ìˆ˜</th><th>ì—°ì†ì •ë‹µ</th></tr></thead>
              <tbody id="rankBody"></tbody>
            </table>
          </div>
        </section>
      </aside>
    </main>

    <footer>
      <div style="opacity:.9">â“’ ENGLISH HELL CAMP â€” â€˜ê°•í•˜ê²Œ, ê°•ì œì ìœ¼ë¡œ, ì—„í•˜ê²Œâ€™. ì§€ê° = ì¬ì‹œí—˜.</div>
    </footer>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // -------------------------------
    // ìƒ˜í”Œ ë°ì´í„° (ê¸°ë³¸ ì„¸íŠ¸)
    // -------------------------------
    let WORDS = [
      { w: 'abandon', k: 'ë²„ë¦¬ë‹¤, í¬ê¸°í•˜ë‹¤', ex: [
        'The captain decided to <b>abandon</b> the sinking ship.',
        'He had to <b>abandon</b> his plan due to lack of funds.',
        'They refused to <b>abandon</b> hope despite difficulties.'
      ]},
      { w: 'derive', k: 'ì–»ë‹¤, ìœ ë˜í•˜ë‹¤', ex: [
        'Many English words <b>derive</b> from Latin.',
        'We can <b>derive</b> a formula from the data.',
        'Happiness can <b>derive</b> from small things.'
      ]},
      { w: 'condemn', k: 'ë¹„ë‚œí•˜ë‹¤, ìœ ì£„ì„ ê³ í•˜ë‹¤', ex: [
        'The leaders <b>condemned</b> the violent attack.',
        'The building was <b>condemned</b> as unsafe.',
        'He was <b>condemned</b> to life imprisonment.'
      ]},
      { w: 'notion', k: 'ê°œë…, ìƒê°', ex: [
        'The <b>notion</b> of freedom is complex.',
        'She rejected the <b>notion</b> that luck decides everything.',
        'He had no <b>notion</b> of what to do.'
      ]},
      { w: 'pursue', k: 'ì¶”êµ¬í•˜ë‹¤, ë’¤ì«“ë‹¤', ex: [
        'She decided to <b>pursue</b> a career in medicine.',
        'The police <b>pursued</b> the suspect through the streets.',
        'We must <b>pursue</b> our goals with discipline.'
      ]}
    ];

    // ìƒíƒœ
    let order = []; let idx = 0; let correct = 0, wrong = 0, streak = 0;
    let ticking = false, timerId = null, remain = 0; let studiedSec = 0; let passTicket = 0; let testMode = false;

    // ìš”ì†Œ ì°¸ì¡°
    const startBtn = document.getElementById('startBtn');
    const retryBtn = document.getElementById('retryBtn');
    const giveupBtn = document.getElementById('giveup');
    const wordEl = document.getElementById('word');
    const hintEl = document.getElementById('hint');
    const answerEl = document.getElementById('answer');
    const feedbackEl = document.getElementById('feedback');
    const exampleList = document.getElementById('exampleList');
    const progressText = document.getElementById('progressText');
    const correctText = document.getElementById('correctText');
    const wrongText   = document.getElementById('wrongText');
    const streakText  = document.getElementById('streakText');
    const timerEl  = document.getElementById('timer');
    const bar = document.getElementById('bar');
    const mTime = document.getElementById('m-time');
    const mAcc  = document.getElementById('m-acc');
    const mFail = document.getElementById('m-fail');
    const mPass = document.getElementById('m-pass');
    const tabs = [...document.querySelectorAll('.tab')];
    const views = { trainer:document.getElementById('view-trainer'), report:document.getElementById('view-report') };
    const badgeCount = document.getElementById('badgeCount');
    const uploadInfo = document.getElementById('uploadInfo');
    const toast = document.getElementById('toast');
    const modeTrain = document.getElementById('modeTrain');
    const modeTest = document.getElementById('modeTest');
    const modeBadge = document.getElementById('modeBadge');

    const excelInput = document.getElementById('excelFile');
    const loadBtn = document.getElementById('loadBtn');

    function toastShow(msg){ toast.textContent = msg; toast.classList.add('show'); setTimeout(()=>toast.classList.remove('show'), 2200); }

    function buzz(){ try{ const ctx = new (window.AudioContext||window.webkitAudioContext)(); const o=ctx.createOscillator(); const g=ctx.createGain(); o.type='square'; o.frequency.value=120; g.gain.setValueAtTime(.2, ctx.currentTime); g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+0.25); o.connect(g).connect(ctx.destination); o.start(); o.stop(ctx.currentTime+0.25);}catch(e){} }

    function tick(){ if(!ticking) return; remain -= .1; studiedSec += .1; updateStudyClock(); if(remain<=0){ remain=0; timerEl.classList.add('bad'); wrong++; streak=0; updateHud(); buzz(); feedback('ì‹œê°„ì´ˆê³¼ â€” ì¬ì‹œí—˜ ê°ì˜¤í•´ë¼.', false); nextQuestion(); } drawTimer(); }

    function updateStudyClock(){ const s = Math.floor(studiedSec); const mm = String(Math.floor(s/60)).padStart(2,'0'); const ss = String(s%60).padStart(2,'0'); mTime.textContent = `${mm}:${ss}`; }
    function drawTimer(){ timerEl.textContent = `${remain.toFixed(1)}s`; const total=10.0; const pct=100*(remain/total); bar.style.width = `${Math.max(0,Math.min(100,pct))}%`; }
    const shuffle = arr => [...arr].sort(()=>Math.random()-.5);

    function startSet(){ if(!WORDS.length){ toastShow('ë‹¨ì–´ì„¸íŠ¸ê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤. ë¨¼ì € ì—…ë¡œë“œí•˜ì„¸ìš”.'); return; }
      order = shuffle(WORDS.map((_,i)=>i)); idx=0; correct=0; wrong=0; streak=0; studiedSec=0; feedback('í›ˆë ¨ ì‹œì‘. íƒ€ì´ë¨¸ëŠ” 10ì´ˆ. ë§ì„¤ì´ë©´ íŒ¨ë°°.', true); updateHud(); answerEl.disabled=false; giveupBtn.disabled=false; retryBtn.disabled=false; answerEl.value=''; answerEl.focus(); showQuestion(); if(timerId) clearInterval(timerId); ticking=true; timerId=setInterval(tick,100); }

    function updateHud(){ progressText.textContent = `${Math.min(idx,order.length)}/${order.length}`; correctText.textContent=correct; wrongText.textContent=wrong; streakText.textContent=`${streak}ğŸ”¥`; const total=Math.max(1,correct+wrong); const acc=Math.round((correct/total)*100); mAcc.textContent=`${acc}%`; mFail.textContent=wrong; mPass.textContent=passTicket; badgeCount.textContent = WORDS.length; }

    function showQuestion(){ if(idx>=order.length){ ticking=false; clearInterval(timerId); timerId=null; answerEl.disabled=true; giveupBtn.disabled=true; const acc = Math.round((correct/Math.max(1,(correct+wrong)))*100); if(acc>=90){ passTicket++; feedback(`ì¢…ë£Œ. ì„±ê³µë¥  ${acc}%. ì§€ì˜¥íƒˆì¶œê¶Œ +1 ì§€ê¸‰.`, true); } else feedback(`ì¢…ë£Œ. ì„±ê³µë¥  ${acc}%. ì¬ì‹œí—˜ ê¶Œì¥.`, acc>=70); updateHud(); return; }
      const q = WORDS[order[idx]]; wordEl.textContent = q.w; hintEl.textContent = `íŒíŠ¸: ${q.k}`; const ex = q.ex && q.ex.length ? q.ex : [`I like <b>${q.w}</b>.`,`You must memorize <b>${q.w}</b> to survive the test.`,`He decided to practice the word <b>${q.w}</b> daily.`]; exampleList.innerHTML = ex.map(s=>`<div class=\"ex\">${s} <i style='color:var(--ink-dim)'>â€” ì´ ë‹¨ì–´ë¥¼ ì´ë ‡ê²Œ ì•ˆ ì™¸ìš°ë©´ ë…í•´ ëª» í•¨.</i></div>`).join('');
      // í…ŒìŠ¤íŠ¸ ëª¨ë“œ: íŒíŠ¸/ì˜ˆë¬¸ ìˆ¨ê¹€
      if (testMode) {
        hintEl.style.display = 'none';
        exampleList.innerHTML = '';
        modeBadge.style.display = '';
      } else {
        hintEl.style.display = '';
        modeBadge.style.display = 'none';
      } remain = 10.0; timerEl.classList.remove('bad'); drawTimer(); }

    function feedback(msg,good){ feedbackEl.style.color = good ? 'var(--ok)' : 'var(--red-2)'; feedbackEl.textContent = msg; }

    function answerSubmit(){ if(idx>=order.length) return; const q = WORDS[order[idx]]; const val = answerEl.value.trim(); const ok = val && q.k.replace(/\s+/g,'').includes(val.replace(/\s+/g,'')); if(ok){ correct++; streak++; feedback('ì •ë‹µ. ë‹¤ìŒ.', true);} else { wrong++; streak=0; feedback(`ì˜¤ë‹µ. ì •ë‹µ íŒíŠ¸: ${q.k}`, false); buzz(); } idx++; updateHud(); answerEl.value=''; nextQuestion(); }
    function nextQuestion(){ setTimeout(showQuestion, 320); }

    // íƒ­ ì „í™˜
    tabs.forEach(t=>t.addEventListener('click', ()=>{ tabs.forEach(x=>x.classList.remove('active')); t.classList.add('active'); const v=t.dataset.view; Object.entries(views).forEach(([k,el])=>{ el.hidden = k!==v; }); }));

    // ë²„íŠ¼/ì…ë ¥ ë°”ì¸ë“œ
    startBtn.addEventListener('click', startSet); retryBtn.addEventListener('click', startSet);
    giveupBtn.addEventListener('click', ()=>{ wrong++; streak=0; updateHud(); buzz(); feedback('í¬ê¸°? ê·¸ëŸ° ë‹¨ì–´ëŠ” ì—†ë‹¤. ê°ì .', false); idx++; nextQuestion(); });
    answerEl.addEventListener('keydown', (e)=>{ if(e.key==='Enter') answerSubmit(); });

    // ëª¨ë“œ ì „í™˜
    modeTrain.addEventListener('click', ()=>{ testMode=false; modeTrain.classList.add('btn-primary'); modeTrain.classList.remove('btn-ghost'); modeTest.classList.add('btn-ghost'); modeTest.classList.remove('btn-primary'); hintEl.style.display=''; modeBadge.style.display='none'; exampleList.innerHTML=''; toastShow('í›ˆë ¨ ëª¨ë“œ: íŒíŠ¸ í‘œì‹œ'); showQuestion(); });
    modeTest.addEventListener('click', ()=>{ testMode=true; modeTest.classList.add('btn-primary'); modeTest.classList.remove('btn-ghost'); modeTrain.classList.add('btn-ghost'); modeTrain.classList.remove('btn-primary'); hintEl.style.display='none'; modeBadge.style.display=''; exampleList.innerHTML=''; toastShow('í…ŒìŠ¤íŠ¸ ëª¨ë“œ: íŒíŠ¸ ì œê±°'); });

    // ë¬¸ì¥ ì˜ˆì‹œ ì°¾ê¸° (ì—…ë¡œë“œ ë‹¨ì–´ ë°˜ì˜)
    document.getElementById('exGo').addEventListener('click', ()=>{ const q = document.getElementById('exSearch').value.trim().toLowerCase(); const hit = WORDS.find(x=>x.w.toLowerCase()===q); const out = document.getElementById('exOut'); if(!hit){ out.innerHTML = `<div class='ex' style='color:var(--red-2)'>ë‹¨ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ.</div>`; return;} const ex = hit.ex && hit.ex.length? hit.ex : [`I like <b>${hit.w}</b>.`,`Memorize <b>${hit.w}</b> or fail.`,`Practice <b>${hit.w}</b> every day.`]; out.innerHTML = ex.map((s,i)=>`<div class='ex'><b>${i+1}.</b> ${s}</div>`).join(''); });

    // ë…í•´ ë¬¸ì œ ìƒì„±ê¸° (ì—…ë¡œë“œ ë‹¨ì–´ ë°˜ì˜)
    document.getElementById('rdMake').addEventListener('click', ()=>{ const w = document.getElementById('rdWord').value.trim().toLowerCase(); if(!w) return; const hit = WORDS.find(x=>x.w.toLowerCase()===w); const meaning = hit ? hit.k : 'â€”'; const tmpl = [ `Despite multiple warnings, the team chose to <b>${w}</b> the safety protocol, which led to serious consequences.`, `For long-term success, it is <b>crucial</b> to build consistent study habits from the first year of high school.`, `Some students <b>${w}</b> challenges, while others confront them and grow stronger.`]; const passage = tmpl.join(' ').replace(new RegExp(`\\b${w}\\b`,'gi'),'_____'); document.getElementById('rdPassage').value = passage + `\n\n[ë¬¸í•­] ìœ„ ê¸€ì˜ ë¹ˆì¹¸ì— ë“¤ì–´ê°ˆ ê°€ì¥ ì ì ˆí•œ ë‹¨ì–´ëŠ”?\n(A) ${w}  (B) notion  (C) maintain  (D) allocate`; const fb = document.getElementById('rdFeedback'); fb.textContent = `íŒíŠ¸: ${w} = ${meaning}`; fb.style.color = '#b5b5b5'; });
    document.getElementById('rdCheck').addEventListener('click', ()=>{ const w = document.getElementById('rdWord').value.trim().toLowerCase(); const ans = document.getElementById('rdAns').value.trim().toLowerCase(); const fb = document.getElementById('rdFeedback'); if(!w) return; if(ans===w){ fb.style.color='var(--ok)'; fb.textContent='ì •ë‹µ. í›ˆë ¨ì„ ê³„ì†í•´ë¼.'; } else { fb.style.color='var(--red-2)'; fb.textContent='ì˜¤ë‹µ. ì¬ë„ì „.'; buzz(); } });

    // ë­í‚¹ ë”ë¯¸
    const rankData = [['#1','HARDMODE99',980,45],['#2','HELLRUNNER',965,40],['#3','NOEXCUSE',950,38],['#4','PANICSTUDY',928,34],['#5','GRINDKING',910,31],['#6','REDALERT',900,29],['#7','FOCUS707',880,27],['#8','RUTHLESS',865,26],['#9','LASTBOSS',850,25],['#10','DISCIPLINE',842,22]];
    document.getElementById('rankBody').innerHTML = rankData.map(r=>`<tr><td>${r[0]}</td><td>${r[1]}</td><td>${r[2]}</td><td>${r[3]}</td></tr>`).join('');

    // ì´ˆê¸° ì¹´ìš´íŠ¸ ë°˜ì˜
    function refreshBadge(){ badgeCount.textContent = WORDS.length; }
    refreshBadge();

    // ===============================
    // ì—‘ì…€ ì—…ë¡œë“œ â†’ WORDS êµì²´ ì—°ê²°
    // ===============================
    loadBtn.addEventListener('click', ()=>{
      const file = excelInput.files && excelInput.files[0]; if(!file){ toastShow('ì—‘ì…€(.xlsx) íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.'); return; }
      const reader = new FileReader();
      reader.onload = function(e){
        try{
          const data = new Uint8Array(e.target.result);
          const wb = XLSX.read(data, { type: 'array' });
          const sheet = wb.Sheets[wb.SheetNames[0]];
          const rows = XLSX.utils.sheet_to_json(sheet, { header:1 });
          const next = [];
          rows.forEach((row,i)=>{
            const eng = (row && row[0]||'').toString().trim();
            const kor = (row && row[1]||'').toString().trim();
            if(!eng || !kor) return;
            next.push({ w: eng, k: kor, ex: [ `I like <b>${eng}</b>.`, `You must memorize <b>${eng}</b> to survive the test.`, `Practice <b>${eng}</b> every day.` ] });
          });
          if(!next.length){ toastShow('ì½ì„ ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤. (ì²« ì—´: ë‹¨ì–´, ë‘˜ì§¸ ì—´: ëœ»)'); return; }
          WORDS = next;
          refreshBadge();
          uploadInfo.textContent = `ì—…ë¡œë“œë¨: ${WORDS.length}ê°œ`;
          toastShow(`ë‹¨ì–´ ${WORDS.length}ê°œ ë¡œë“œ ì™„ë£Œ. í›ˆë ¨ì„ ì¬ì‹œì‘í•˜ì„¸ìš”.`);
          // ì§„í–‰ ì¤‘ì´ë©´ ì¬ì‹œì‘ ìœ ë„
          if(ticking){ ticking=false; clearInterval(timerId); answerEl.disabled=true; giveupBtn.disabled=true; retryBtn.disabled=false; feedback('ìƒˆ ì„¸íŠ¸ê°€ ë¡œë“œë¨. ì¬ì‹œí—˜ ë²„íŠ¼ìœ¼ë¡œ ë‹¤ì‹œ ì‹œì‘.', true); }
        }catch(err){ console.error(err); toastShow('íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.'); }
      };
      reader.readAsArrayBuffer(file);
    });
  </script>
</body>
</html>
